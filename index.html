<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</title>

<style>
@page {
    size: A4;
    margin: 15mm;
}

body {
    font-family: Tahoma, Arial, sans-serif;
    margin: 0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* ===== Ø§Ù„Ù‡ÙŠØ¯Ø± ===== */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo-box {
    text-align: center;
    font-size: 11px;
    font-weight: bold;
}

.logo-box img { height: 70px; }

/* ===== Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ===== */
h2, h3 {
    text-align: center;
    margin: 4px 0;
}

.date {
    text-align: center;
    font-weight: bold;
    font-size: 13px;
    margin-bottom: 6px;
}

.content { flex: 1; }

/* ===== Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª ===== */
.controls {
    text-align: center;
    margin: 8px 0;
}

.controls button, .controls input, .controls select {
    padding: 5px 10px;
    margin: 2px;
    font-size: 12px;
    font-weight: bold;
    cursor: pointer;
}

/* ===== Ø§Ù„Ø¬Ø¯ÙˆÙ„ ===== */
.table-wrapper {
    width: 72%;
    margin: 0 auto 6px;
}

table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
}

th, td {
    border: 2px solid #000;
    font-size: 10.5px;
    height: 18px;
    text-align: center;
}

th { background: #eaeaea; }

.num-col { width: 10%; }
.name-col { width: 45%; }
.loc-col  { width: 45%; }

input, select {
    width: 100%;
    height: 100%;
    border: none;
    font-size: 10.5px;
    background: transparent;
    text-align: center;
}

#morningTable tbody td { background: #fff6cc; }
#eveningTable tbody td { background: #e6f2ff; }

/* ===== Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ ===== */
.center-totals {
    text-align: center;
    font-weight: bold;
    font-size: 13px;
    margin: 6px 0;
}

/* ===== Ø§Ù„ÙÙˆØªØ± ===== */
.footer { margin-top: auto; }

.signatures {
    display: flex;
    justify-content: space-between;
    font-weight: bold;
    font-size: 13px;
}

.time-picker { display:none; margin:5px 0; }

@media print {
    .controls, .time-picker { display: none; }
}
</style>
</head>

<body>

<!-- ===== Ø§Ù„Ù‡ÙŠØ¯Ø± ===== -->
<div class="header">
    <div class="logo-box">
        <img src="majdoul.png">
        
    </div>
    <div class="logo-box">
        <img src="linkexpert.png">
      
    </div>
</div>

<h2>Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
<div class="date" id="dateTime"></div>

<!-- ===== Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª ===== -->
<div class="controls">
    <button onclick="window.print()">ğŸ–¨ï¸ PDF</button>
    <button onclick="exportExcel()">ğŸ“Š Excel</button>
    <button onclick="clearData()">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
    <button onclick="setMode('morning')">â˜€ï¸ ØµØ¨Ø§Ø­</button>
    <button onclick="setMode('evening')">ğŸŒ™ Ù…Ø³Ø§Ø¡</button>
    <button onclick="setMode('all')">ğŸ“‹ ÙƒØ§Ù…Ù„</button>
    <button onclick="toggleDate()">ğŸ•’ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®</button>
    <input type="datetime-local" id="customDate" onchange="applyDate()" style="display:none;">
    <button onclick="toggleTime()">â° ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª</button>
</div>

<!-- ===== ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª ÙÙ‚Ø· ===== -->
<div class="time-picker" id="timePicker">
    <input type="number" id="hour" min="1" max="12" placeholder="Ø³Ø§Ø¹Ø©" style="width:50px;">
    :
    <input type="number" id="minute" min="0" max="59" placeholder="Ø¯Ù‚ÙŠÙ‚Ø©" style="width:50px;">
    <select id="ampm">
        <option>AM</option>
        <option>PM</option>
    </select>
    <button onclick="applyCustomTime()">ØªØ·Ø¨ÙŠÙ‚</button>
</div>

<div class="content">

<h3 id="morningTitle">ØªØ­Ø¶ÙŠØ± Ø§Ù„ØµØ¨Ø§Ø­</h3>
<div class="table-wrapper" id="morningWrap">
<table id="morningTable">
<thead>
<tr>
    <th class="num-col">#</th>
    <th class="name-col">Ø§Ù„Ø§Ø³Ù…</th>
    <th class="loc-col">Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<h3 id="eveningTitle">ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø¡</h3>
<div class="table-wrapper" id="eveningWrap">
<table id="eveningTable">
<thead>
<tr>
    <th class="num-col">#</th>
    <th class="name-col">Ø§Ù„Ø§Ø³Ù…</th>
    <th class="loc-col">Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

</div>

<!-- ===== Ø§Ù„ÙÙˆØªØ± ===== -->
<div class="footer">
<div class="center-totals">
    Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ØµØ¨Ø§Ø­: <span id="morningTotal">0</span> |
    Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø³Ø§Ø¡: <span id="eveningTotal">0</span> |
    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="grandTotal">0</span>
</div>

<div class="signatures">
    <div>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©<br>Ø³Ù„Ù…Ø§Ù† Ø§Ù„Ø­Ù…ÙˆØ¯</div>
    <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹<br>Ø³Ø§Ù„Ù… Ø§Ù„Ø´Ù…Ø±ÙŠ</div>
</div>
</div>

<script>
const locations = `
<option value="">â€” Ø§Ø®ØªØ± â€”</option>
<option>Ù…ØªØ­Ø±Ùƒ</option>
<option>ØªØºØ·ÙŠØ§Øª</option>
<option>Ù…Ù†Ø¸Ù… Ù…ÙˆØ§Ù‚Ù P1</option>
<option>Ù…Ù†Ø¸Ù… Ù…ÙˆØ§Ù‚Ù P2</option>
<option>Ù…Ù†Ø¸Ù… Ù…ÙˆØ§Ù‚Ù P3</option>
<option>Ù…Ù†Ø¸Ù… Ù…ÙˆØ§Ù‚Ù P4</option>
<option>Ù…Ù†Ø¸Ù… Ø¨ÙˆØ§Ø¨Ø© 3</option>
<option>Ù…Ù†Ø¸Ù… Ø¨ÙˆØ§Ø¨Ø© 5</option>
<option>Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ø­Ù† A</option>
<option>Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ø­Ù† P2</option>
<option>ÙØ§Ù„ÙŠÙ‡ Ù¡</option>
<option>ÙØ§Ù„ÙŠÙ‡ Ù¢</option>
<option>ÙØ§Ù„ÙŠÙ‡ Ù£ - ÙØ­Øµ</option>
`;

function createRows(id, count){
    const tb = document.querySelector(`#${id} tbody`);
    for(let i=1;i<=count;i++){
        tb.innerHTML += `
        <tr>
            <td>${i}</td>
            <td><input oninput="calc()"></td>
            <td><select onchange="calc()">${locations}</select></td>
        </tr>`;
    }
}

function calc(){
    let m=0,e=0;
    document.querySelectorAll("#morningTable tbody tr").forEach(r=>{
        if(r.querySelector("input").value && r.querySelector("select").value) m++;
    });
    document.querySelectorAll("#eveningTable tbody tr").forEach(r=>{
        if(r.querySelector("input").value && r.querySelector("select").value) e++;
    });
    morningTotal.textContent=m;
    eveningTotal.textContent=e;
    grandTotal.textContent=m+e;
}

function clearData(){
    document.querySelectorAll("input").forEach(i=>i.value="");
    document.querySelectorAll("select").forEach(s=>s.selectedIndex=0);
    calc();
}

function setMode(mode){
    morningWrap.style.display = (mode==="evening")?"none":"block";
    morningTitle.style.display = (mode==="evening")?"none":"block";
    eveningWrap.style.display = (mode==="morning")?"none":"block";
    eveningTitle.style.display = (mode==="morning")?"none":"block";
}

/* ===== ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® ===== */
function toggleDate(){
    const input = document.getElementById("customDate");
    input.style.display = (input.style.display==="none")?"inline-block":"none";
}

function applyDate(){
    const input = document.getElementById("customDate");
    if(!input.value) return;
    const d = new Date(input.value);
    document.getElementById("dateTime").textContent = formatDateTime(d);
    input.style.display="none";
}

/* ===== ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª ÙÙ‚Ø· ===== */
function toggleTime(){
    const picker = document.getElementById("timePicker");
    picker.style.display = (picker.style.display==="none")?"block":"none";
}

function applyCustomTime(){
    const hour = parseInt(document.getElementById("hour").value) || 0;
    const minute = parseInt(document.getElementById("minute").value) || 0;
    const ampm = document.getElementById("ampm").value;

    let h = hour;
    if(ampm==="PM" && hour<12) h+=12;
    if(ampm==="AM" && hour===12) h=0;

    const now = new Date();
    now.setHours(h,minute);

    document.getElementById("dateTime").textContent = formatDateTime(now);
}

/* ===== ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® + Ø§Ù„ÙˆÙ‚Øª ===== */
function formatDateTime(d){
    return d.toLocaleDateString('en-GB', {
        weekday:'long', day:'2-digit', month:'long', year:'numeric'
    }) + " | " +
    d.toLocaleTimeString('en-US', {hour:'2-digit', minute:'2-digit', hour12:true});
}

/* ===== ØªØµØ¯ÙŠØ± Excel Ù…Ø¹ UTF-8 ===== */
function exportExcel(){
    let csv = "\uFEFFØ§Ù„ÙØªØ±Ø©,Ø§Ù„Ø±Ù‚Ù…,Ø§Ù„Ø§Ø³Ù…,Ø§Ù„Ù…ÙˆÙ‚Ø¹\n"; // BOM utf-8
    document.querySelectorAll("#morningTable tbody tr").forEach((r,i)=>{
        csv += `ØµØ¨Ø§Ø­,${i+1},${r.querySelector("input").value},${r.querySelector("select").value}\n`;
    });
    document.querySelectorAll("#eveningTable tbody tr").forEach((r,i)=>{
        csv += `Ù…Ø³Ø§Ø¡,${i+1},${r.querySelector("input").value},${r.querySelector("select").value}\n`;
    });
    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "attendance.csv";
    link.click();
}

/* Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ */
const now = new Date();
document.getElementById("dateTime").textContent = formatDateTime(now);

/* Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ */
createRows("morningTable",19);
createRows("eveningTable",10);
</script>

</body>
</html>
